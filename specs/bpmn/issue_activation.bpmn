<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="Definitions_IssueActivation" targetNamespace="http://example.com/bpmn/giftcerts">
  <bpmn:process id="Process_IssueActivation" name="Gift Certificate Issuance and Activation" isExecutable="false">
    <bpmn:laneSet id="LaneSet_IssueActivation">
      <bpmn:lane id="Lane_BatchLoader" name="GiftCertificateBatchLoader">
        <bpmn:flowNodeRef>StartEvent_BatchPlan</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_PrepareBatch</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_SendBatch</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_GiftProcessing" name="GiftCertificateProcessing">
        <bpmn:flowNodeRef>Task_ValidateBatch</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_PersistCertificates</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_PublishIssued</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_ListenPayments</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_ActivateCertificate</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_OnlineStore" name="OnlineStore">
        <bpmn:flowNodeRef>Task_ListGiftCertificate</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_SubmitOrder</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_Payments" name="Payments">
        <bpmn:flowNodeRef>Task_ProcessPayment</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>Task_PublishPaymentEvent</bpmn:flowNodeRef>
      </bpmn:lane>
      <bpmn:lane id="Lane_SMSGateway" name="SMS Gateway">
        <bpmn:flowNodeRef>Task_SendCVC</bpmn:flowNodeRef>
        <bpmn:flowNodeRef>EndEvent_ActivationComplete</bpmn:flowNodeRef>
      </bpmn:lane>
    </bpmn:laneSet>
    <bpmn:startEvent id="StartEvent_BatchPlan" name="Plan Batch"/>
    <bpmn:task id="Task_PrepareBatch" name="Prepare Code Batch"/>
    <bpmn:task id="Task_SendBatch" name="Upload Batch to API"/>
    <bpmn:task id="Task_ValidateBatch" name="Validate Batch"/>
    <bpmn:task id="Task_PersistCertificates" name="Create Certificates"/>
    <bpmn:task id="Task_PublishIssued" name="Publish GiftCertificateState(Issued)"/>
    <bpmn:task id="Task_ListGiftCertificate" name="List Certificate Product"/>
    <bpmn:task id="Task_SubmitOrder" name="Submit Customer Order"/>
    <bpmn:task id="Task_ProcessPayment" name="Charge Payment"/>
    <bpmn:task id="Task_PublishPaymentEvent" name="Publish All_Payments Event"/>
    <bpmn:task id="Task_ListenPayments" name="Correlate Order & Payment"/>
    <bpmn:task id="Task_ActivateCertificate" name="Activate Certificate"/>
    <bpmn:task id="Task_SendCVC" name="Send SMS with CVC"/>
    <bpmn:endEvent id="EndEvent_ActivationComplete" name="Certificate Active"/>
    <bpmn:sequenceFlow id="Flow_1" sourceRef="StartEvent_BatchPlan" targetRef="Task_PrepareBatch"/>
    <bpmn:sequenceFlow id="Flow_2" sourceRef="Task_PrepareBatch" targetRef="Task_SendBatch"/>
    <bpmn:sequenceFlow id="Flow_3" sourceRef="Task_SendBatch" targetRef="Task_ValidateBatch"/>
    <bpmn:sequenceFlow id="Flow_4" sourceRef="Task_ValidateBatch" targetRef="Task_PersistCertificates"/>
    <bpmn:sequenceFlow id="Flow_5" sourceRef="Task_PersistCertificates" targetRef="Task_PublishIssued"/>
    <bpmn:sequenceFlow id="Flow_6" sourceRef="Task_PublishIssued" targetRef="Task_ListGiftCertificate"/>
    <bpmn:sequenceFlow id="Flow_7" sourceRef="Task_ListGiftCertificate" targetRef="Task_SubmitOrder"/>
    <bpmn:sequenceFlow id="Flow_8" sourceRef="Task_SubmitOrder" targetRef="Task_ProcessPayment"/>
    <bpmn:sequenceFlow id="Flow_9" sourceRef="Task_ProcessPayment" targetRef="Task_PublishPaymentEvent"/>
    <bpmn:sequenceFlow id="Flow_10" sourceRef="Task_PublishPaymentEvent" targetRef="Task_ListenPayments"/>
    <bpmn:sequenceFlow id="Flow_11" sourceRef="Task_ListenPayments" targetRef="Task_ActivateCertificate"/>
    <bpmn:sequenceFlow id="Flow_12" sourceRef="Task_ActivateCertificate" targetRef="Task_SendCVC"/>
    <bpmn:sequenceFlow id="Flow_13" sourceRef="Task_SendCVC" targetRef="EndEvent_ActivationComplete"/>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_IssueActivation">
    <bpmndi:BPMNPlane id="BPMNPlane_IssueActivation" bpmnElement="Process_IssueActivation">
      <bpmndi:BPMNShape id="LaneShape_BatchLoader" bpmnElement="Lane_BatchLoader">
        <dc:Bounds x="120" y="60" width="2500" height="100"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="LaneShape_GiftProcessing" bpmnElement="Lane_GiftProcessing">
        <dc:Bounds x="120" y="160" width="2500" height="100"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="LaneShape_OnlineStore" bpmnElement="Lane_OnlineStore">
        <dc:Bounds x="120" y="260" width="2500" height="100"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="LaneShape_Payments" bpmnElement="Lane_Payments">
        <dc:Bounds x="120" y="360" width="2500" height="100"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="LaneShape_SMSGateway" bpmnElement="Lane_SMSGateway">
        <dc:Bounds x="120" y="460" width="2500" height="100"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_StartEvent_BatchPlan" bpmnElement="StartEvent_BatchPlan">
        <dc:Bounds x="160" y="102" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_PrepareBatch" bpmnElement="Task_PrepareBatch">
        <dc:Bounds x="220" y="90" width="120" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_SendBatch" bpmnElement="Task_SendBatch">
        <dc:Bounds x="360" y="90" width="140" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_ValidateBatch" bpmnElement="Task_ValidateBatch">
        <dc:Bounds x="520" y="190" width="140" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_PersistCertificates" bpmnElement="Task_PersistCertificates">
        <dc:Bounds x="680" y="190" width="150" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_PublishIssued" bpmnElement="Task_PublishIssued">
        <dc:Bounds x="860" y="190" width="190" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_ListGiftCertificate" bpmnElement="Task_ListGiftCertificate">
        <dc:Bounds x="1080" y="290" width="200" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_SubmitOrder" bpmnElement="Task_SubmitOrder">
        <dc:Bounds x="1300" y="290" width="200" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_ProcessPayment" bpmnElement="Task_ProcessPayment">
        <dc:Bounds x="1520" y="390" width="170" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_PublishPaymentEvent" bpmnElement="Task_PublishPaymentEvent">
        <dc:Bounds x="1710" y="390" width="200" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_ListenPayments" bpmnElement="Task_ListenPayments">
        <dc:Bounds x="1940" y="190" width="200" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_ActivateCertificate" bpmnElement="Task_ActivateCertificate">
        <dc:Bounds x="2160" y="190" width="170" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_Task_SendCVC" bpmnElement="Task_SendCVC">
        <dc:Bounds x="2350" y="490" width="170" height="60"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_EndEvent_ActivationComplete" bpmnElement="EndEvent_ActivationComplete">
        <dc:Bounds x="2540" y="502" width="36" height="36"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1_di" bpmnElement="Flow_1">
        <di:waypoint x="196" y="120"/>
        <di:waypoint x="220" y="120"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_2_di" bpmnElement="Flow_2">
        <di:waypoint x="340" y="120"/>
        <di:waypoint x="360" y="120"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_3_di" bpmnElement="Flow_3">
        <di:waypoint x="500" y="120"/>
        <di:waypoint x="520" y="220"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_4_di" bpmnElement="Flow_4">
        <di:waypoint x="660" y="220"/>
        <di:waypoint x="680" y="220"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_5_di" bpmnElement="Flow_5">
        <di:waypoint x="830" y="220"/>
        <di:waypoint x="860" y="220"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_6_di" bpmnElement="Flow_6">
        <di:waypoint x="1050" y="220"/>
        <di:waypoint x="1080" y="320"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_7_di" bpmnElement="Flow_7">
        <di:waypoint x="1280" y="320"/>
        <di:waypoint x="1300" y="320"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_8_di" bpmnElement="Flow_8">
        <di:waypoint x="1500" y="320"/>
        <di:waypoint x="1520" y="420"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_9_di" bpmnElement="Flow_9">
        <di:waypoint x="1690" y="420"/>
        <di:waypoint x="1710" y="420"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_10_di" bpmnElement="Flow_10">
        <di:waypoint x="1910" y="420"/>
        <di:waypoint x="1940" y="220"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_11_di" bpmnElement="Flow_11">
        <di:waypoint x="2140" y="220"/>
        <di:waypoint x="2160" y="220"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_12_di" bpmnElement="Flow_12">
        <di:waypoint x="2330" y="220"/>
        <di:waypoint x="2350" y="520"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_13_di" bpmnElement="Flow_13">
        <di:waypoint x="2520" y="520"/>
        <di:waypoint x="2540" y="520"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
