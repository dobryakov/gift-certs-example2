# План задач

- **Команда Сервиса Процессинга Подарочных Сертификатов**
  - **ID 1.0 — Проектирование и развёртывание Kafka-топиков GiftCertificate.\***  
    **Описание:** Создать и настроить топики `GiftCertificate.Commands`, `GiftCertificates.State`, `GiftCertificate.Notifications`, `GiftCertificate.Audit`; обеспечить схемы сообщений и ACL.  
    **Definition of Done:** Топики созданы в DEV/QA/PROD, схемы зарегистрированы, тестовая публикация успешна.  
    **Acceptance Criteria:** Сообщения читаются потребителями без ошибок десериализации, задержка < 200 мс.  
    **Тест-кейсы:** Проверка публикации/чтения каждым сервисом; проверка ACL отрицательного сценария.  
    **Срок:** 2 недели.  
    **Роли:** Архитектор Kafka, DevOps, Backend-разработчик.

  - **ID 1.1 — Реализация ядра жизненного цикла сертификата**  
    **Описание:** Реализовать обработку команд issue/redeem/refund, управление статусами, генерацию CVC, хранение истории.  
    **Definition of Done:** Unit-тесты > 80% покрытия, интеграционные тесты с in-memory Kafka проходят.  
    **Acceptance Criteria:** Переходы статусов соответствуют бизнес-правилам; поддержка частичного списания.  
    **Тест-кейсы:** Нормальный выпуск, частичное списание, полный возврат, отказ по каналу.  
    **Срок:** 3 недели (после ID 1.0).  
    **Роли:** Backend-разработчики, QA, Архитектор домена.

  - **ID 1.2 — HTTP API для поддержки и диагностики**  
    **Описание:** Реализовать OpenAPI-описанные эндпоинты, добавить OAuth2, аудит вызовов.  
    **Definition of Done:** Эндпоинты задеплоены, Swagger доступен, безопасность протестирована.  
    **Acceptance Criteria:** Время ответа < 300 мс, пагинация корректна, логирование полно.  
    **Тест-кейсы:** Запрос сертификата, фильтрация, блокировка.  
    **Срок:** 2 недели (параллельно с ID 1.1 второй половины).  
    **Роли:** Backend-разработчик, QA, Security Engineer.

- **Команда Payments**
  - **ID 2.0 — Поддержка возвратов по сертификатам**  
    **Описание:** Добавить обработку новых команд от GCP Service, обеспечить возврат на исходный метод либо запрос реквизитов.  
    **Definition of Done:** Обработаны новые события, Payments публикует результат в `All_Payments`.  
    **Acceptance Criteria:** Возврат проходит < 1 мин, ошибки логируются.  
    **Тест-кейсы:** Успешный возврат, невозможность возврата, повторный запрос.  
    **Срок:** 2 недели (после ID 1.1 готовности схем).  
    **Роли:** Backend Payments, QA.

- **Команда Orders**
  - **ID 3.0 — Расширение модели заказа для учёта сертификатов**  
    **Описание:** Добавить ссылки на сертификаты, публикацию enriched событий, валидацию каналов.  
    **Definition of Done:** Заказы с сертификатами видны в `All_SalesOrder`, тесты обновлены.  
    **Acceptance Criteria:** Одна запись на транзакцию, корректные ссылки на сертификаты.  
    **Тест-кейсы:** Покупка с сертификатом, возврат, без сертификата.  
    **Срок:** 2 недели (параллельно с ID 1.1).  
    **Роли:** Backend Orders, Data Engineer.

- **Команда CRM**
  - **ID 4.0 — Отправка CVC и хранение истории уведомлений**  
    **Описание:** Подписаться на `GiftCertificate.Notifications`, отправлять CVC, логировать результат.  
    **Definition of Done:** Уведомления доставляются, CRM фиксирует статус.  
    **Acceptance Criteria:** SLA доставки < 5 мин, дубликаты исключены.  
    **Тест-кейсы:** Успешная отправка email/SMS, сбой с ретраем.  
    **Срок:** 1 неделя (после ID 1.1 сообщения).  
    **Роли:** CRM-разработчик, QA.

- **Команда Internet Store**
  - **ID 5.0 — Интеграция checkout с подарочными сертификатами**  
    **Описание:** Публиковать команды issue, отображать статус, поддерживать оплату сертификатом.  
    **Definition of Done:** UI обновлён, новые тесты, события публикуются.  
    **Acceptance Criteria:** Checkout без задержек, корректная информация о балансе.  
    **Тест-кейсы:** Покупка сертификата, покупка с сертификатом, ошибка платежа.  
    **Срок:** 3 недели (зависит от ID 1.1, ID 3.0).  
    **Роли:** Frontend, Backend, QA.

- **Команда POS**
  - **ID 6.0 — Поддержка частичного списания и возвратов**  
    **Описание:** Добавить публикацию команд redeem/refund, отображать остаток.  
    **Definition of Done:** POS интегрирован с Kafka, UI обновлён.  
    **Acceptance Criteria:** Сценарии тестированы на пилотной точке, нет пересечения каналов.  
    **Тест-кейсы:** Частичное списание, полный возврат, неверный канал.  
    **Срок:** 4 недели (после ID 1.1).  
    **Роли:** POS-разработчик, QA, Retail Ops.

- **Команда BI**
  - **ID 7.0 — Агрегация отчётности по сертификатам**  
    **Описание:** Настроить коннекторы к новым топикам, построить витрины продаж/возвратов.  
    **Definition of Done:** BI обновлено, отчёты публикуются ежедневно.  
    **Acceptance Criteria:** Доступность витрин 99%, данные актуальны < 30 мин.  
    **Тест-кейсы:** Сверка с Orders, контроль невалидных событий.  
    **Срок:** 2 недели (после ID 1.0).  
    **Роли:** Data Engineer, BI Analyst.

## Правила ведения

- Обновление задач выполняется по итогам каждого релиза GCP Service.
