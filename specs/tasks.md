# Список задач

## GiftCertificateProcessing

- [1] Проектирование схемы GiftCertificateDB
  - Описание задачи: разработать ERD и миграции для таблиц `gift_certificate`, `gift_certificate_operation`, `authorization_hold`, `audit_log`.
  - Definition of Done: миграции применены в dev/qa, ERD согласован, тестовые данные создаются автоматически.
  - Acceptance Criteria: таблицы соответствуют ERD, поддерживают основные атрибуты и связи, покрыты unit-тестами репозиториев.
  - Предполагаемый срок реализации: 3 недели.
  - Роли сотрудников для выполнения: архитектор данных, backend-разработчик, DevOps-инженер.

- [2] Реализация событийных слушателей
  - Описание задачи: реализовать подписку на `All_SalesOrder` и `All_Payments` с корреляцией заказов и оплат.
  - Definition of Done: логика корреляции покрыта интеграционными тестами, обеспечена идемпотентность.
  - Acceptance Criteria: при получении тестового заказа и оплаты создаётся активированный сертификат и событие `GiftCertificateState`.
  - Предполагаемый срок реализации: 2 недели.
  - Роли сотрудников для выполнения: backend-разработчик, инженер по интеграциям, QA-инженер.

- [3] API авторизации и списания
  - Описание задачи: реализовать REST-эндпоинты `authorize` / `capture` / `void` с поддержкой Redis-кэша.
  - Definition of Done: API описан в OpenAPI, покрыт автотестами, настроен rate limiting.
  - Acceptance Criteria: каналы `OnlineStore` и `POS` успешно проводят авторизацию и списание в QA, баланс корректно обновляется.
  - Предполагаемый срок реализации: 3 недели.
  - Роли сотрудников для выполнения: backend-разработчик, инженер по безопасности, QA-инженер.

- [4] Аудит и публикация событий
  - Описание задачи: реализовать аудит операций и публикацию событий `GiftCertificateTransaction` и `GiftCertificateBI`.
  - Definition of Done: события логируются, доступны в Kafka, проведена проверка формата, реализован DLQ.
  - Acceptance Criteria: BI-коннектор получает тестовое событие и сохраняет в витрину, аудит отображает метаданные.
  - Предполагаемый срок реализации: 2 недели.
  - Роли сотрудников для выполнения: backend-разработчик, инженер по данным, инженер эксплуатации.

## GiftCertificateBatchLoader

- [5] Инструмент массовой загрузки
  - Описание задачи: создать инструмент/скрипт для формирования и отправки пакетов сертификатов.
  - Definition of Done: инструмент документирован, поддерживает dry-run и валидацию, CI контролирует качество.
  - Acceptance Criteria: тестовый пакет в QA приводит к созданию сертификатов, ошибки формируются в отчёте.
  - Предполагаемый срок реализации: 1 неделя.
  - Роли сотрудников для выполнения: backend-разработчик, инженер по данным, технический писатель.

## OnlineStore

- [6] Интеграция с API сертификатов
  - Описание задачи: добавить в фронт вызовы `authorize` / `capture` и отображение баланса.
  - Definition of Done: фронт покрыт e2e-тестами, UI отображает остаток, обрабатывает ошибки.
  - Acceptance Criteria: пользователь может применить сертификат и видеть итоговый баланс на QA.
  - Предполагаемый срок реализации: 2 недели.
  - Роли сотрудников для выполнения: frontend-разработчик, UX-дизайнер, QA-инженер.

## POS

- [7] Интеграция POS с API
  - Описание задачи: реализовать сценарии проверки баланса и списания в POS.
  - Definition of Done: требования согласованы, тесты на кассовом окружении, инструкции для продавцов.
  - Acceptance Criteria: кассир проводит оплату сертификатом и получает чек с остатком.
  - Предполагаемый срок реализации: 2 недели.
  - Роли сотрудников для выполнения: инженер POS-платформы, аналитик бизнес-процессов, тренер по обучению персонала.

## Payments

- [8] Обогащение событий оплат
  - Описание задачи: добавить к событиям `All_Payments` атрибуты, указывающие на покупку сертификата и операции возврата.
  - Definition of Done: изменения задокументированы, обратная совместимость сохранена.
  - Acceptance Criteria: `GiftCertificateProcessing` корректно активирует сертификат на основе события в QA.
  - Предполагаемый срок реализации: 1 неделя.
  - Роли сотрудников для выполнения: backend-разработчик, инженер по интеграциям, QA-инженер.

## BI Pipeline

- [9] Коннектор GiftCertificateBI
  - Описание задачи: настроить потребление топика `GiftCertificateBI` и загрузку в витрину.
  - Definition of Done: коннектор деплоен, мониторится, схемы документированы.
  - Acceptance Criteria: BI получает демо-набор событий и строит отчёт остатков.
  - Предполагаемый срок реализации: 2 недели.
  - Роли сотрудников для выполнения: инженер по данным, аналитик BI, DevOps-инженер.

## SMS Gateway

- [10] Отправка CVC по SMS
  - Описание задачи: настроить интеграцию с существующим SMS-шлюзом для доставки CVC.
  - Definition of Done: конфигурация хранится безопасно, предусмотрен повтор отправки.
  - Acceptance Criteria: при покупке сертификата в QA клиент получает SMS с CVC.
  - Предполагаемый срок реализации: 1 неделя.
  - Роли сотрудников для выполнения: инженер по интеграциям, специалист по информационной безопасности, QA-инженер.
